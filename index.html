<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://i.ibb.co/bjK8Fckv/Whats-App-Image-2025-10-31-at-19-53-38-bd329551.jpg"  type="image/png">
    <title>FalconixGaming - Gaming Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
            color: #F9FAFB; /* text-gray-50 */
        }
        .font-black-ops {
            font-family: 'Inter', sans-serif;
            font-weight: 900;
        }
        #gameCanvas, #racerGameCanvas, #towerDefenseCanvas {
            display: block;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        .glassmorphism {
            background: rgba(31, 41, 55, 0.6); /* bg-gray-800 with opacity */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .btn-primary {
            @apply px-6 py-3 font-semibold text-white bg-sky-500 rounded-lg shadow-md hover:bg-sky-600 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-secondary {
            @apply px-6 py-3 font-semibold text-white bg-indigo-500 rounded-lg shadow-md hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-danger {
            @apply px-6 py-3 font-semibold text-white bg-pink-600 rounded-lg shadow-md hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-success {
            @apply px-6 py-3 font-semibold text-white bg-green-600 rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
         .btn-warning {
            @apply px-6 py-3 font-semibold text-white bg-yellow-500 rounded-lg shadow-md hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-orange {
            @apply px-6 py-3 font-semibold text-white bg-orange-500 rounded-lg shadow-md hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        /* New Outline Button Styles */
        .btn-primary-outline {
            @apply px-6 py-3 font-semibold text-sky-400 bg-transparent border-2 border-sky-500 rounded-lg shadow-md hover:bg-sky-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-secondary-outline {
            @apply px-6 py-3 font-semibold text-indigo-400 bg-transparent border-2 border-indigo-500 rounded-lg shadow-md hover:bg-indigo-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-danger-outline {
            @apply px-6 py-3 font-semibold text-pink-500 bg-transparent border-2 border-pink-600 rounded-lg shadow-md hover:bg-pink-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-success-outline {
            @apply px-6 py-3 font-semibold text-green-500 bg-transparent border-2 border-green-600 rounded-lg shadow-md hover:bg-green-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .btn-warning-outline {
            @apply px-6 py-3 font-semibold text-yellow-500 bg-transparent border-2 border-yellow-500 rounded-lg shadow-md hover:bg-yellow-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105;
        }
        .game-card:hover .game-card-overlay {
            opacity: 1;
        }
        .game-card-overlay {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        #pixelRacerModal, #towerDefenseModal, #ticTacToeModal, #memoryMatchModal {
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .pointer-events-passthrough {
            pointer-events: none;
        }
        .pointer-events-auto {
            pointer-events: auto;
        }
        
        /* Tic-Tac-Toe Styles */
        .ttt-cell, .memory-card-face {
            font-family: 'Fredoka One', cursive;
        }
        .ttt-cell {
            transition: background-color 0.2s ease-in-out;
        }
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .winning-cell {
            animation: celebrate 0.8s ease-in-out;
            background-color: rgba(59, 130, 246, 0.3) !important;
        }

        /* Memory Game Specific Styles */
        .memory-game-board {
            perspective: 1000px;
        }
        .memory-card {
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }
        .memory-card.is-flipped {
            transform: rotateY(180deg);
        }
        .memory-card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
        }
        .memory-card-front {
            background-color: #4b5563; /* bg-gray-600 */
        }
        .memory-card-back {
            background-color: #3b82f6; /* bg-blue-600 */
            transform: rotateY(180deg);
            font-size: 2.5rem; /* Emoji size */
        }
        .memory-card.matched .memory-card-back {
            background-color: #16a34a; /* bg-green-600 */
        }

        /* Scrollbar Hiding Utility */
       .hide-scrollbar::-webkit-scrollbar {
           display: none;
       }
       .hide-scrollbar {
           -ms-overflow-style: none;  /* IE and Edge */
           scrollbar-width: none;  /* Firefox */
       }

        /* Fullscreen on mobile */
        @media (max-width: 768px) {
            #pixelRacerModal, #towerDefenseModal, #ticTacToeModal, #memoryMatchModal {
                padding: 0;
            }
            #pixelRacerModal > div, #towerDefenseModal > div, #ticTacToeModal > div, #memoryMatchModal > div {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                border-radius: 0;
            }
            #pixelRacerModal .aspect-\[3\/4\], #towerDefenseModal .aspect-\[4\/3\] {
                aspect-ratio: auto; /* Remove fixed aspect ratio */
                height: 100%;
                width: 100%;
            }
            #closeRacerModal, #closeTowerDefenseModal, #closeTicTacToeModal, #closeMemoryMatchModal {
                top: 1rem;
                right: 1rem;
                background-color: rgba(0,0,0,0.5);
                color: white;
                z-index: 100;
            }
        }

        /* --- NEW ANIMATION FOR PRIZE TEXT --- */
        @keyframes pulse-text {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.9;
            }
        }
        .pulse-text-animation {
            animation: pulse-text 2s ease-in-out infinite;
        }
        /* --- END OF NEW CSS --- */
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-gray-900/80 backdrop-blur-sm sticky top-0 z-50 border-b border-gray-700">
        <nav class="container mx-auto px-4 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="#" class="text-3xl font-black-ops text-white">FALCONIX<span class="text-sky-400">GAMING</span></a>
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#" class="text-gray-300 hover:text-sky-400 transition-colors">Home</a>
                    <a href="#games" class="text-gray-300 hover:text-sky-400 transition-colors">Games</a>
                    <a href="#how-to-play" class="text-gray-300 hover:text-sky-400 transition-colors">How to Play</a>
                    <a href="leaderboard.html" class="text-gray-300 hover:text-sky-400 transition-colors">Leaderboards</a>
                </div>
                <div class="hidden md:flex items-center space-x-4">
                    <button id="login-button" class="btn-primary">Login with Google</button>
                    <div id="user-info" class="hidden items-center space-x-4">
                        <div id="user-display-name" class="text-white font-semibold text-right"></div>
                        <button id="logout-button" class="px-6 py-3 font-semibold text-red-500 hover:bg-red-500/10 rounded-lg transition-colors duration-300">Logout</button>
                    </div>
                </div>
                <!-- Mobile Menu Button -->
                 <button id="mobile-menu-button" class="md:hidden text-gray-300 hover:text-white">
                     <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                 </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700">Home</a>
                <a href="#games" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700">Games</a>
                <a href="#how-to-play" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700">How to Play</a>
                <a href="leaderboard.html" class="block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700">Leaderboards</a>
                <button id="mobile-login-button" class="w-full text-left block px-3 py-2 rounded-md text-base font-medium text-gray-300 hover:text-white hover:bg-gray-700">Login with Google</button>
                <div id="mobile-user-info" class="hidden px-3 py-2">
                    <div id="mobile-user-display-name" class="block text-base font-medium text-white"></div>
                    <button id="mobile-logout-button" class="w-full text-left mt-2 block px-3 py-2 rounded-md text-base font-medium text-red-500 hover:bg-gray-700">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow">
        <!-- Hero Section / Featured Game -->
        <section id="featured-game" class="relative h-[600px] bg-gray-900 overflow-hidden">
            <div id="gameContainer" class="absolute inset-0">
                <canvas id="gameCanvas"></canvas>
            </div>
            <div id="uiLayer" class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                <div id="startScreen" class="flex flex-col items-center justify-center pointer-events-auto">
                    <h1 class="text-5xl md:text-7xl font-black-ops text-white uppercase tracking-wider">Astro <span class="text-sky-400">Jumper</span></h1>
                    <p class="mt-4 text-lg text-gray-300 max-w-2xl">Survive the longest in the asteroid belt. Click to jump. Don't fall into the void!</p>
                    <button id="playButton" class="btn-primary mt-8 text-xl">Play Now</button>
                    <!-- *** UPDATED PRIZE ANNOUNCEMENT ON FRONT PAGE *** -->
                    <p id="prize-announcement" class="mt-6 text-2xl font-bold text-yellow-300 pulse-text-animation">
                        Play & Win ‚Çπ400! üí∞
                    </p>
                    <!-- *** NEW SEASON 1 DATE INFO *** -->
                    <p class="mt-2 text-lg font-semibold text-gray-200">
                        Season 1 is ON! <span class="text-white">(Nov 1st - Nov 30th)</span>
                    </p>
                    <!-- *** NEW: REFERRAL INFO DIV *** -->
                    <div id="referral-info" class="text-green-400 mt-4 text-lg font-semibold hidden">
                        <!-- JS will populate this -->
                    </div>
                </div>
                <div id="inGameUI" class="hidden absolute top-5 left-5 text-left pointer-events-passthrough">
                    <p class="text-2xl font-bold">Score: <span id="score">0</span></p>
                </div>
                <div id="gameOverScreen" data-game-name="Astro Jumper" class="hidden flex-col items-center justify-center glassmorphism p-8 rounded-2xl pointer-events-auto">
                    <h2 class="text-5xl font-black-ops text-white">GAME OVER</h2>
                    <p class="mt-4 text-2xl text-gray-200">Final Score: <span id="finalScore" class="font-bold text-sky-400">0</span></p>
                    <div class="mt-6 flex flex-col sm:flex-row gap-4">
                        <button id="restartButton" class="btn-primary-outline text-xl">Play Again</button>
                        <button id="shareAstroJumperScore" class="btn-secondary-outline text-xl">Share Score</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Games Grid Section -->
        <section id="games" class="py-16 sm:py-24 bg-gray-800/50">
            <div class="container mx-auto px-4 lg:px-8">
                <h2 class="text-4xl font-black-ops text-center mb-4">Our Games</h2>
                <!-- *** NEW SEASON 1 DATE INFO *** -->
                <p class="text-lg font-semibold text-center text-yellow-300 mb-12">
                    Season 1 is ON! <span class="text-white">(Nov 1st - Nov 30th)</span>
                </p>
                <!-- *** END OF NEW CONTENT *** -->
                <!-- This container will be a flex row on mobile and a grid on larger screens -->
                <div class="flex overflow-x-auto space-x-6 pb-4 sm:grid sm:grid-cols-2 sm:gap-8 lg:grid-cols-4 hide-scrollbar">
                    <!-- Game Card 1 -->
                    <div id="astro-jumper-card" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 cursor-pointer w-64 sm:w-auto flex-shrink-0">
                        <img src="https://img.gamepix.com/games/astro-jumper/cover/astro-jumper.png?w=400&ar=16:10" alt="Astro Jumper" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute inset-0 p-6 flex flex-col justify-end">
                            <div class="flex items-center gap-3">
                                <svg class="w-8 h-8 text-sky-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <h3 class="text-xl sm:text-2xl font-bold text-white">Astro Jumper</h3>
                            </div>
                            <p class="text-sky-300 mt-1">3D Platformer</p>
                        </div>
                        <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                            <span class="btn-primary pointer-events-none">Play Now</span>
                        </div>
                    </div>
                    <!-- Game Card 2 -->
                    <div id="pixel-racer-card" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 cursor-pointer w-64 sm:w-auto flex-shrink-0">
                        <img src="https://as2.ftcdn.net/v2/jpg/04/81/59/51/1000_F_481595196_xeOLb1vk53gjYT1o2cz8hvfN4hkg83PB.jpg" alt="Car Racer" class="w-full h-full object-cover">
                         <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute inset-0 p-6 flex flex-col justify-end">
                             <div class="flex items-center gap-3">
                                 <svg class="w-8 h-8 text-pink-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                 <h3 class="text-xl sm:text-2xl font-bold text-white">Car Racer</h3>
                               </div>
                            <p class="text-pink-400 mt-1">2D Arcade Racer</p>
                        </div>
                         <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                            <span class="btn-danger pointer-events-none">Play Now</span>
                        </div>
                    </div>
                    <!-- Game Card 3 -->
                    <div id="tower-defense-card" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 cursor-pointer w-64 sm:w-auto flex-shrink-0">
                        <img src="https://fs-prod-cdn.nintendo-europe.com/media/images/10_share_images/games_15/nintendo_switch_download_software_1/2x1_NSwitchDS_FantasyTowerDefense_image1600w.jpg" alt="Tower Defense" class="w-full h-full object-cover">
                         <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute inset-0 p-6 flex flex-col justify-end">
                            <div class="flex items-center gap-3">
                                <svg class="w-8 h-8 text-green-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <h3 class="text-xl sm:text-2xl font-bold text-white">Tower Defense</h3>
                            </div>
                            <p class="text-green-400 mt-1">Strategy</p>
                        </div>
                         <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                            <span class="btn-success pointer-events-none">Play Now</span>
                        </div>
                    </div>
                    <!-- Game Card 4 -->
                    <div id="tic-tac-toe-card" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 cursor-pointer w-64 sm:w-auto flex-shrink-0">
                        <img src="https://wallpapercave.com/wp/wp8984750.jpg" alt="Tic-Tac-Toe" class="w-full h-full object-cover">
                         <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute inset-0 p-6 flex flex-col justify-end">
                            <div class="flex items-center gap-3">
                                <svg class="w-8 h-8 text-purple-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <h3 class="text-xl sm:text-2xl font-bold text-white">Tic-Tac-Toe</h3>
                            </div>
                            <p class="text-purple-400 mt-1">Classic Puzzle</p>
                        </div>
                         <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                            <span class="btn-secondary pointer-events-none">Play Now</span>
                        </div>
                    </div>
                     <!-- Game Card 5 -->
                    <div id="memory-match-card" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 cursor-pointer w-64 sm:w-auto flex-shrink-0">
                        <img src="https://img.gamedistribution.com/854fd8048c814acaa86b0faffe364290-1280x720.jpeg" alt="Memory Match" class="w-full h-full object-cover">
                         <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute inset-0 p-6 flex flex-col justify-end">
                            <div class="flex items-center gap-3">
                                <svg class="w-8 h-8 text-orange-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                <h3 class="text-xl sm:text-2xl font-bold text-white">Memory Match</h3>
                            </div>
                            <p class="text-orange-400 mt-1">Puzzle</p>
                        </div>
                         <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                            <span class="btn-warning pointer-events-none">Play Now</span>
                        </div>
                    </div>
                    <!-- Coming Soon Card -->
                    <div class="group relative rounded-lg overflow-hidden shadow-lg cursor-not-allowed filter grayscale w-64 sm:w-auto flex-shrink-0">
                        <img src="https://placehold.co/400x250/1f2937/6b7280?text=?" alt="Coming Soon" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute inset-0 p-6 flex flex-col justify-end">
                            <div class="flex items-center gap-3">
                                <svg class="w-8 h-8 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" /></svg>
                                <h3 class="text-xl sm:text-2xl font-bold text-white">Coming Soon</h3>
                            </div>
                            <p class="text-gray-400 mt-1">Stay Tuned!</p>
                        </div>
                        <div class="absolute inset-0 bg-black/70 flex items-center justify-center">
                            <span class="btn-secondary opacity-50 pointer-events-none">Coming Soon</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
<!-- Multiplayer Games Section -->
<section id="multiplayer-games" class="py-16 sm:py-24 bg-gray-900/50">
    <div class="container mx-auto px-4 lg:px-8">
        <h2 class="text-4xl font-black-ops text-center mb-12">Multiplayer Games</h2>
        <!-- This container will be a flex row on mobile and a grid on larger screens -->
        <div class="flex overflow-x-auto space-x-6 pb-4 sm:grid sm:grid-cols-2 sm:gap-8 lg:grid-cols-4 hide-scrollbar">
            <!-- Game Card 1 -->
            <a href="mptictactoe.html" target="_blank" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 w-64 sm:w-auto flex-shrink-0">
                <img src="https://www.rd.com/wp-content/uploads/2019/10/tic-tac-toe-scaled.jpg" alt="Tic-Tac-Toe" class="w-full h-full object-cover">
                 <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                <div class="absolute inset-0 p-6 flex flex-col justify-end">
                    <div class="flex items-center gap-3">
                        <svg class="w-8 h-8 text-orange-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <h3 class="text-xl sm:text-2xl font-bold text-white">Tic-Tac-Toe</h3>
                    </div>
                    <p class="text-orange-400 mt-1">Puzzle</p>
                </div>
                 <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                    <span class="btn-warning pointer-events-none">Play Now</span>
                </div>
            </a>
            <!-- Game Card 2: Memory Match -->
            <a href="mpmemory.html" target="_blank" class="group relative rounded-lg overflow-hidden shadow-lg transform hover:-translate-y-2 transition-transform duration-300 w-64 sm:w-auto flex-shrink-0">
                <img src="https://static.vecteezy.com/system/resources/previews/012/672/122/original/memory-game-for-preschool-children-cards-with-cartoon-safari-desert-animals-activity-page-for-book-vector.jpg" alt="Memory Match" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                <div class="absolute inset-0 p-6 flex flex-col justify-end">
                    <div class="flex items-center gap-3">
                        <svg class="w-8 h-8 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 15l3-3m0 0l-3-3m3 3h-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <h3 class="text-xl sm:text-2xl font-bold text-white">Memory Match</h3>
                    </div>
                    <p class="text-yellow-400 mt-1">Puzzle</p>
                </div>
                <div class="game-card-overlay absolute inset-0 bg-black/70 flex items-center justify-center">
                    <span class="btn-warning pointer-events-none">Play Now</span>
                </div>
            </a>
            <!-- Coming Soon Card -->
            <div class="group relative rounded-lg overflow-hidden shadow-lg cursor-not-allowed filter grayscale w-64 sm:w-auto flex-shrink-0">
                <img src="https://placehold.co/400x250/1f2937/6b7280?text=?" alt="Coming Soon" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                <div class="absolute inset-0 p-6 flex flex-col justify-end">
                    <div class="flex items-center gap-3">
                        <svg class="w-8 h-8 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" /></svg>
                        <h3 class="text-xl sm:text-2xl font-bold text-white">Coming Soon</h3>
                    </div>
                    <p class="text-gray-400 mt-1">More Multiplayer Fun!</p>
                </div>
                <div class="absolute inset-0 bg-black/70 flex items-center justify-center">
                    <span class="btn-secondary opacity-50 pointer-events-none">Coming Soon</span>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- *** Season 1 Prize Modal *** -->
<div id="season-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
    <div class="glassmorphism p-8 rounded-2xl text-center max-w-md w-full relative">
        <button id="close-season-modal" class="absolute top-3 right-3 text-gray-400 hover:text-white transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
        <h3 class="text-3xl font-black-ops text-yellow-300">Season 1 Challenge</h3>
        <p class="mt-4 text-xl text-gray-200">
            The top-ranked player for <strong class="text-white">each game</strong> on the global leaderboard at the end of the season will win a prize!
        </p>
        <!-- *** UPDATED PRIZE IN MODAL *** -->
        <p class="mt-4 text-2xl font-bold text-white">Prize: <span class="text-green-400">Upto ‚Çπ400!</span> üí∞</p>
        <p class="mt-2 text-lg text-gray-300">
            Season 1 runs from <strong class="text-white">November 1st</strong> to <strong class="text-white">November 30th, 2025</strong>.
        </p>
        <p class="mt-4 text-gray-400 text-sm">Scores will be finalized at midnight (IST) on November 30th. Winners will be announced on December 1st. Good luck!</p>
                    <!-- *** NEW WHATSAPP LINK ADDED *** -->
            <p class="mt-6 text-lg">
                <a href="https://chat.whatsapp.com/JOHZ6qwcTFTEfpP58MGBpx?mode=wwt" target="_blank" rel="noopener noreferrer" class="text-green-400 hover:text-green-300 font-semibold underline transition-colors">
                    Join our Whatsapp community
                </a>
            </p>
    </div>
</div>
<!-- *** UPDATED: Season 1 Headline *** -->
<section id="season-announcement" class="py-12 bg-gray-800/50">
    <div class="container mx-auto px-4 lg:px-8">
        <div class="text-center glassmorphism p-6 rounded-lg max-w-3xl mx-auto">
            <h2 class="text-3xl font-black-ops text-yellow-300">Season 1 is LIVE!</h2>
            <!-- *** UPDATED PRIZE IN HEADLINE *** -->
            <p class="text-lg text-gray-200 mt-2">
                Compete from <strong class="text-white">Nov 1st - Nov 30th</strong>. The top player in each game wins <strong class="text-green-400">‚Çπ100!</strong> üí∞
            </p>
            <!-- This button ID needs to match the new JS listener -->
            <button id="main-view-prizes-btn" class="mt-4 px-5 py-2 font-semibold text-white bg-indigo-500 rounded-lg shadow-md hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105">
                View Details
            </button>
                       <button id="view-rules-btn" class="px-3 py-1 sm:px-5 sm:py-2 text-sm sm:text-base font-semibold text-indigo-400 bg-transparent border-2 border-indigo-500 rounded-lg shadow-md hover:bg-indigo-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-75 transition-all duration-300 transform hover:scale-105">
                             <a href="leaderboard.html"> Global Leaderboard</a>
                       </button>
        </div>
    </div>
    
</section>
        <!-- Leaderboards Section -->
        <section id="leaderboards" class="py-16 sm:py-24 bg-gray-800/50">
            <div class="container mx-auto px-4 lg:px-8">
                <h2 class="text-4xl font-black-ops text-center mb-12">Your High Scores</h2>
                <div id="leaderboard-content" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Leaderboard cards will be injected here -->
                </div>
                 <div id="leaderboard-login-prompt" class="text-center text-gray-400">
                     <p>Please log in to see your high scores.</p>
                 </div>
            </div>

        </section>


        <!-- How to Play Section -->
        <section id="how-to-play" class="py-16 sm:py-24 bg-gray-900">
            <div class="container mx-auto px-4 lg:px-8 text-center">
                <h2 class="text-4xl font-black-ops text-center mb-4">How to Play</h2>
                <p class="text-lg text-gray-400 mb-8 max-w-3xl mx-auto">Select a game below for instructions on its objective and controls.</p>
                <div class="flex flex-wrap justify-center gap-4 mb-12">
                    <button class="btn-primary game-info-btn" data-game="Astro Jumper">Astro Jumper</button>
                    <button class="btn-danger game-info-btn" data-game="Car Racer">Car Racer</button>
                    <button class="btn-success game-info-btn" data-game="Tower Defense">Tower Defense</button>
                    <button class="btn-secondary game-info-btn" data-game="Tic-Tac-Toe">Tic-Tac-Toe</button>
                    <button class="btn-warning game-info-btn" data-game="Memory Match">Memory Match</button>
                </div>
                <div id="gameExplanationResult" class="mt-12 min-h-[200px] flex items-center justify-center">
                    <p class="text-gray-500">Select a game to see instructions.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-700">
                     <!-- NEW SOCIAL ICONS DIV -->
            <div class="flex justify-center space-x-6 mb-4" style="margin-top: 20px;">
                <!-- WhatsApp Icon Link -->
                <a href="https://chat.whatsapp.com/JOHZ6qwcTFTEfpP58MGBpx?mode=wwt" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors duration-300">
                    <span class="sr-only">WhatsApp</span>
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.04 2.02c-5.52 0-9.99 4.47-9.99 9.99 0 1.78.47 3.45 1.32 4.9l-1.34 4.9c-.08.29.02.6.24.82.22.22.53.32.82.24l4.9-1.34c1.45.84 3.12 1.32 4.9 1.32s9.99-4.47 9.99-9.99-4.47-9.99-9.99-9.99zm0 18.23c-1.63 0-3.18-.4-4.5-1.12l-.32-.19-3.34.91.93-3.25-.21-.34c-.8-1.38-1.22-2.99-1.22-4.66 0-4.56 3.7-8.26 8.26-8.26s8.26 3.7 8.26 8.26-3.7 8.26-8.26 8.26zm4.52-6.13c-.25-.12-1.47-.73-1.7-.81-.23-.08-.39-.12-.56.12-.17.25-.64.81-.79.98-.14.17-.29.19-.54.06-.25-.12-1.06-.39-2.02-1.25-.74-.66-1.23-1.48-1.38-1.73-.14-.25-.02-.38.11-.5.12-.11.25-.29.38-.43.12-.14.17-.25.25-.41.08-.17.04-.31-.02-.43-.06-.12-.56-1.34-.76-1.84-.2-.49-.4-.42-.56-.43-.15-.01-.31-.01-.47-.01-.17 0-.43.06-.66.31-.23.25-.87.85-.87 2.07 0 1.22.89 2.4 1.01 2.56.12.17 1.76 2.69 4.27 3.77 2.51 1.08 2.51.72 2.96.69.45-.03 1.47-.6 1.68-1.18.21-.58.21-1.08.14-1.18-.05-.11-.2-.17-.44-.29z"></path></svg>
                </a>
                <!-- YouTube Icon Link -->
                <a href="https://youtube.com/@pmt20?si=ki_H-Cqi1guiSrrM" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors duration-300">
                    <span class="sr-only">YouTube</span>
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg>
                </a>
                <!-- Instagram Icon Link -->
                <a href="https://www.instagram.com/thenameispabitra_?igsh=MXRmODdlanQwcnp5bQ==" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-colors duration-300">
                    <span class="sr-only">Instagram</span>
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.148 3.227-1.669 4.771-4.919 4.919-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-3.252-.148-4.771-1.691-4.919-4.919-.058-1.265-.07-1.646-.07-4.85s.012-3.584.07-4.85c.148-3.227 1.669 4.771 4.919-4.919 1.266-.058 1.646.07 4.85-.07zm0-2.163c-3.273 0-3.662.014-4.948.072-4.305.197-7.304 3.196-7.502 7.502-.058 1.287-.072 1.675-.072 4.948s.014 3.661.072 4.948c.198 4.305 3.196 7.304 7.502 7.502 1.287.058 1.675.072 4.948.072s3.661-.014 4.948-.072c4.305-.197 7.304-3.196 7.502-7.502.058-1.287.072-1.675.072-4.948s-.014-3.661-.072-4.948c-.198-4.305-3.196-7.304-7.502-7.502-1.287-.058-1.675-.072-4.948-.072zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44 1.441-.645 1.441-1.44-.645-1.44-1.441-1.44z"></path></svg>
                </a>
            </div>
        <div class="container mx-auto px-4 lg:px-8 py-8 text-center text-gray-400">
            <p>&copy; 2025 <a href="https://chat.whatsapp.com/DUXdfaOxJoPC87KjRWbkjo" style="text-decoration:underline;">FalconixGaming</a>. All Rights Reserved.</p>
            <div class="flex justify-center space-x-6 mt-4">
                <a href="https://wa.me/qr/MRKTOLBP5VHRI1" class="hover:text-white">Privacy Policy</a>
                <a href="https://wa.me/qr/MRKTOLBP5VHRI1" class="hover:text-white">Terms of Service</a>
                <a href="https://wa.me/qr/MRKTOLBP5VHRI1" class="hover:text-white">Contact</a>
            </div>
        </div>
    </footer>

    <!-- MODALS -->

    <!-- Logout Confirmation Modal -->
    <div id="logout-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="glassmorphism p-8 rounded-2xl text-center max-w-sm w-full">
            <h3 class="text-2xl font-bold text-white">Are you sure?</h3>
            <p class="mt-2 text-gray-300">You will be logged out of your account.</p>
            <div class="mt-6 flex justify-center gap-4">
                <button id="cancel-logout-btn" class="btn-primary">Cancel</button>
                <button id="confirm-logout-btn" class="px-6 py-3 font-semibold text-red-500 bg-transparent border border-red-500 rounded-lg hover:bg-red-500 hover:text-white transition-colors duration-300">Confirm Logout</button>
            </div>
        </div>
    </div>

    <!-- Mobile Welcome Modal -->
    <div id="mobile-welcome-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden md:hidden">
        <div class="glassmorphism p-8 rounded-2xl text-center max-w-sm w-full relative">
            <button id="close-welcome-modal" class="absolute top-2 right-2 text-gray-400 hover:text-white">
                 <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <h2 class="text-3xl font-black-ops text-white">Welcome to <br>FALCONIX<span class="text-sky-400">GAMING</span></h2>
            <p class="mt-4 text-gray-300">Log in to save your high scores and compete on the leaderboards!</p>
            <button id="modal-login-button" class="btn-primary w-full mt-6 text-lg">
                Login with Google
            </button>
        </div>
    </div>
    
    <!-- Car Racer Game Modal -->
    <div id="pixelRacerModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 invisible opacity-0">
        <div class="w-full max-w-md lg:max-w-lg relative">
            <div class="bg-gray-800 rounded-lg shadow-2xl overflow-hidden aspect-[3/4] relative">
                <canvas id="racerGameCanvas"></canvas>
                <div id="racerUiLayer" class="absolute inset-0 flex flex-col items-center justify-center text-center p-4 pointer-events-none">
                    <div id="racerStartScreen" class="pointer-events-auto flex flex-col items-center">
                        <h2 class="text-5xl font-black-ops text-white">CAR <span class="text-pink-500">RACER</span></h2>
                        <p class="mt-4 text-gray-300 px-4">Use Arrow Keys on desktop, or Drag your finger on mobile to move!</p>
                        <button id="racerStartButton" class="btn-danger mt-8 text-xl">Start Race</button>
                    </div>
                    <div id="racerInGameUI" class="hidden absolute top-5 left-5 text-left">
                        <p class="text-2xl font-bold text-white">Score: <span id="racerScore">0</span></p>
                    </div>
                    <div id="racerGameOverScreen" data-game-name="Car Racer" class="hidden flex-col items-center justify-center glassmorphism p-8 rounded-2xl pointer-events-auto">
                        <h2 class="text-5xl font-black-ops text-white">CRASHED!</h2>
                        <p class="mt-4 text-2xl text-gray-200">Final Score: <span id="racerFinalScore" class="font-bold text-pink-400">0</span></p>
                        <div class="mt-6 flex flex-col sm:flex-row gap-4">
                            <button id="racerRestartButton" class="btn-danger-outline text-xl">Try Again</button>
                            <button id="shareRacerScore" class="btn-secondary-outline text-xl">Share Score</button>
                        </div>
                    </div>
                </div>
            </div>
            <button id="closeRacerModal" class="absolute -top-2 -right-2 bg-white rounded-full p-1 text-gray-800 hover:bg-gray-200">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            </button>
        </div>
    </div>

    <!-- Tower Defense Game Modal -->
    <div id="towerDefenseModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 invisible opacity-0">
        <div class="w-full max-w-4xl relative">
            <div class="bg-gray-800 rounded-lg shadow-2xl overflow-hidden aspect-[4/3] relative">
                <canvas id="towerDefenseCanvas"></canvas>
                <div id="tdUiLayer" class="absolute inset-0 flex flex-col items-center justify-center text-center p-4 pointer-events-none">
                    <div id="tdStartScreen" class="pointer-events-auto flex flex-col items-center">
                        <h2 class="text-5xl font-black-ops text-white">TOWER <span class="text-green-500">DEFENSE</span></h2>
                        <p class="mt-4 text-gray-300">Place towers to stop the enemies from reaching the end!</p>
                        <button id="tdStartButton" class="btn-success mt-8 text-xl">Start Game</button>
                    </div>
                     <div id="tdInGameUI" class="hidden absolute top-0 left-0 w-full h-full pointer-events-none">
                         <div class="absolute top-2 left-2 text-left bg-gray-900/50 p-2 rounded-lg">
                             <p class="font-bold text-white">‚ù§Ô∏è Health: <span id="tdHealth"></span></p>
                             <p class="font-bold text-white">üí∞ Gold: <span id="tdGold"></span></p>
                             <p class="font-bold text-white">üåä Wave: <span id="tdWave"></span></p>
                         </div>
                         <div id="tdTowerSelection" class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-4 pointer-events-auto">
                             <button id="buyTurretButton" class="bg-gray-700 p-3 rounded-lg border-2 border-transparent hover:border-green-400">
                                 <p class="font-bold">Turret</p>
                                 <p class="text-sm">Cost: 100üí∞</p>
                             </button>
                         </div>
                         <button id="nextWaveButton" class="absolute bottom-2 right-2 btn-success pointer-events-auto">Next Wave</button>
                     </div>
                    <div id="tdGameOverScreen" data-game-name="Tower Defense" class="hidden flex-col items-center justify-center glassmorphism p-8 rounded-2xl pointer-events-auto">
                        <h2 id="tdEndTitle" class="text-5xl font-black-ops text-white"></h2>
                        <p class="mt-4 text-2xl text-gray-200">You survived <span id="tdFinalWave" class="font-bold text-green-400">0</span> waves.</p>
                        <div class="mt-8 flex flex-col sm:flex-row gap-4">
                            <button id="tdRestartButton" class="btn-success-outline text-xl">Play Again</button>
                            <button id="shareTDScore" class="btn-secondary-outline text-xl">Share Score</button>
                        </div>
                    </div>
                </div>
            </div>
            <button id="closeTowerDefenseModal" class="absolute -top-2 -right-2 bg-white rounded-full p-1 text-gray-800 hover:bg-gray-200">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            </button>
        </div>
    </div>

    <!-- Tic-Tac-Toe Game Modal -->
    <div id="ticTacToeModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 invisible opacity-0">
        <div class="w-full max-w-sm relative">
            <div class="bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-2xl w-full border border-gray-700">
                <div class="text-center mb-4">
                    <h1 class="text-5xl font-bold text-gray-100" style="font-family: 'Fredoka One', cursive;">Tic-Tac-Toe</h1>
                </div>
                <div id="ttt-scoreboard" class="flex justify-around text-center mb-4">
                    <div>
                        <p class="text-lg font-bold text-red-500">Player X</p>
                        <p id="ttt-score-x" class="text-3xl font-bold text-gray-100">0</p>
                    </div>
                    <div>
                        <p class="text-lg font-bold text-blue-400">Player O</p>
                        <p id="ttt-score-o" class="text-3xl font-bold text-gray-100">0</p>
                    </div>
                </div>
                <div id="ttt-status" class="text-center text-xl font-semibold text-gray-400 mb-6 h-8 flex items-center justify-center"></div>
                <div id="ttt-game-board" class="grid grid-cols-3 gap-3 mb-6">
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="0"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="1"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="2"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="3"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="4"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="5"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="6"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="7"></div>
                    <div class="ttt-cell bg-gray-700 h-24 sm:h-28 rounded-lg flex items-center justify-center text-5xl cursor-pointer hover:bg-gray-600" data-index="8"></div>
                </div>
                <div id="ttt-button-container" class="space-y-2">
                    <button id="ttt-next-round-button" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-300 transition-all duration-200 hidden">Next Round</button>
                    <button id="ttt-restart-button" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-200">Restart Game</button>
                </div>
            </div>
            <button id="closeTicTacToeModal" class="absolute -top-2 -right-2 bg-white rounded-full p-1 text-gray-800 hover:bg-gray-200">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            </button>
        </div>
    </div>

    <!-- Memory Match Game Modal -->
    <div id="memoryMatchModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 invisible opacity-0">
        <div class="w-full max-w-lg relative">
             <div class="bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-2xl w-full border border-gray-700">
                <div class="text-center mb-4">
                    <h1 class="text-5xl font-bold text-gray-100" style="font-family: 'Fredoka One', cursive;">Memory Match</h1>
                    <p class="text-gray-400 mt-2">Moves: <span id="moves-count" class="font-bold">0</span></p>
                </div>
                <div id="memory-game-board" class="grid grid-cols-4 gap-4 mb-6 memory-game-board">
                    <!-- Cards will be generated by JavaScript -->
                </div>
                <button id="memory-restart-button" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-200">
                    Restart Game
                </button>
            </div>
            <button id="closeMemoryMatchModal" class="absolute -top-2 -right-2 bg-white rounded-full p-1 text-gray-800 hover:bg-gray-200">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            </button>
        </div>
    </div>

    <!-- Memory Match Win Modal -->
    <div id="memoryMatchWinModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="glassmorphism p-8 rounded-2xl text-center max-w-sm w-full">
            <h2 class="text-5xl font-black-ops text-white">You Won!</h2>
            <p class="mt-4 text-2xl text-gray-200">Finished in <span id="memoryFinalMoves" class="font-bold text-yellow-400">0</span> moves!</p>
            <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
                 <button id="memoryRestartButtonWin" class="btn-warning-outline text-xl">Play Again</button>
                 <button id="shareMemoryScore" class="btn-secondary-outline text-xl">Share Score</button>
            </div>
        </div>
    </div>

    <!-- Fallback Share Modal -->
    <div id="shareModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="glassmorphism p-8 rounded-2xl text-center max-w-md w-full relative">
            <button id="closeShareModal" class="absolute top-2 right-2 text-gray-400 hover:text-white">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <h3 class="text-2xl font-bold text-white">Share Your Score!</h3>
            <p class="mt-2 text-gray-300">Share your achievement with your friends.</p>
            <textarea id="shareText" class="w-full bg-gray-900 text-white rounded-lg p-2 mt-4 h-24 resize-none" readonly></textarea>
            <button id="copyShareText" class="btn-primary w-full mt-4">Copy Text</button>
            <div class="mt-4 flex justify-center gap-4">
                <a id="whatsappShareLink" href="#" target="_blank" class="btn-success">WhatsApp</a>
                <a id="twitterShareLink" href="#" target="_blank" class="btn-primary">Twitter</a>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdnjs.cloudflare.com/ajax/libs/three.js/0.157.0/three.module.js",
            "cannon-es": "https://unpkg.com/cannon-es@0.20.0/dist/cannon-es.js",
            "firebase/app": "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"
        }
    }
    </script>

    <!-- *** NEW AUTH & REFERRAL SCRIPT *** -->
    <!-- This script loads *before* games.js to provide auth and referral functions -->
    <script type="module">
        import { initializeApp } from 'firebase/app';
        import { 
            getFirestore, doc, getDoc, setDoc, updateDoc, 
            serverTimestamp, increment 
        } from 'firebase/firestore';
        import { 
            getAuth, GoogleAuthProvider, 
            signInWithPopup, getAdditionalUserInfo 
        } from 'firebase/auth';

        console.log("Auth & Referral Script: Initializing Firebase...");

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD02ui4dhTuGLz-Ff1af36ERdqqsn4iIeU",
            authDomain: "falconixgaming-46210.firebaseapp.com",
            projectId: "falconixgaming-46210",
            storageBucket: "falconixgaming-46210.appspot.com",
            messagingSenderId: "1096905282147",
            appId: "1:1096905282147:web:e2faa9105d31c6ec009e56",
            measurementId: "G-VJ6YC0GXK5"
        };

        let app, db, auth, provider;

        try {
            // Initialize Firebase
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            provider = new GoogleAuthProvider();
            console.log("Auth & Referral Script: Firebase initialized.");

            // *** EXPOSE TO globalThis (window) for games.js to use ***
            // This allows games.js to access these initialized services and functions
            globalThis.app = app;
            globalThis.db = db;
            globalThis.auth = auth;
            globalThis.provider = provider;
            globalThis.handleSuccessfulLogin = handleSuccessfulLogin; // The referral logic function
            globalThis.signInWithPopup = signInWithPopup; // Pass the auth function
            globalThis.getAdditionalUserInfo = getAdditionalUserInfo; // Pass the auth utility

        } catch (error) {
            console.error("Auth & Referral Script: Firebase initialization failed:", error);
            // Optionally, display this error to the user in a UI element
        }
        
        /**
         * Checks for a referral ID in the URL and stores it in session storage.
         */
        function checkReferralOnLoad() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const referrerId = urlParams.get('ref');
                const referralInfoEl = document.getElementById('referral-info');
                
                if (referrerId) {
                    console.log(`Auth & Referral Script: Referral ID detected: ${referrerId}`);
                    // Store in session storage to survive page reloads before login
                    sessionStorage.setItem('referrerId', referrerId);
                    if (referralInfoEl) {
                        referralInfoEl.textContent = `Joining through a friend's invite! You're awesome.`;
                        referralInfoEl.classList.remove('hidden');
                    }
                }
            } catch (e) {
                console.error("Error reading referral param:", e);
            }
        }

        /**
         * Handles the referral bonus logic after a successful login.
         * This function is EXPOSED to games.js via globalThis.
         * @param {User} user - The Firebase user object from the login result.
         * @param {boolean} isNewUser - Whether this is the user's first login.
         */
        async function handleSuccessfulLogin(user, isNewUser) {
            console.log(`Auth & Referral Script: handleSuccessfulLogin. User: ${user.uid}, isNewUser: ${isNewUser}`);
            
            const userDocRef = doc(db, 'highscores', user.uid);
            const referrerId = sessionStorage.getItem('referrerId');
            
            let hasRedeemed = false;
            try {
                // Check if this user has *already* redeemed a referral
                const userDocSnap = await getDoc(userDocRef);
                if (userDocSnap.exists() && userDocSnap.data().redeemedReferral) {
                    hasRedeemed = true;
                }
            } catch (e) {
                console.error("Error checking existing user doc:", e);
            }

            // ** APPLY BONUS IF: It's a new user AND there's a referrerId AND they haven't already redeemed **
            if (isNewUser && referrerId && !hasRedeemed) {
                console.log(`Applying referral bonus for referrer: ${referrerId}`);
                
                const referrerDocRef = doc(db, 'highscores', referrerId);
                const bonusAmount = 50; // The 50 point bonus

                try {
                    // Atomically increment the referrer's "Car Racer" score
                    await updateDoc(referrerDocRef, {
                        "Car Racer": increment(bonusAmount),
                        "Car Racer_timestamp": serverTimestamp()
                    });
                    console.log(`Bonus of ${bonusAmount} applied to referrer ${referrerId}`);

                    // Mark this new user as having redeemed the referral
                    // This also creates their document for the first time
                    await setDoc(userDocRef, {
                        playerName: user.displayName || 'New Player',
                        playerEmail: user.email,
                        redeemedReferral: referrerId, // Mark as redeemed
                        joinedAt: serverTimestamp()
                    }, { merge: true }); // Use merge to not overwrite existing scores

                    // Clear the referrerId from session storage so it's not reused
                    sessionStorage.removeItem('referrerId');

                } catch (error) {
                    console.error(`Failed to apply referral bonus:`, error);
                    // Don't block the login, just log the error
                }
            }

            // Standard create/update user's own profile doc (runs for everyone)
            await setDoc(userDocRef, {
                playerName: user.displayName || 'New Player',
                playerEmail: user.email,
                lastLogin: serverTimestamp()
            }, { merge: true }); // Use merge to not overwrite scores or referral status

            console.log("Auth & Referral Script: Login/Referral logic complete.");
            // games.js is expected to handle UI updates after this promise resolves
        }

        // Check for referral immediately on page load
        checkReferralOnLoad();

    </script>

    <script src="games.js" type="module"></script>
</body>
</html>
